version: '3.2'
services:
  openfoam_cbp:
    build:
      context: ../
    ports:
      - '3000:3000'

  cypress_firefox:
    image: "cypress/included:10.0.0"
    depends_on:
      - openfoam_cbp
    command:
      --browser firefox
    working_dir: /tests
    volumes:
      - ./:/tests
    environment:
      - CYPRESS_baseUrl=http://openfoam_cbp:3000
      #- CYPRESS_baseUrl=http://host.docker.internal:3000
    #extra_hosts:
    #  - "host.docker.internal:host-gateway"

  cypress_chrome:
    image: "cypress/included:10.0.0"
    depends_on:
      - openfoam_cbp
    command:
      --browser chrome
    working_dir: /tests
    volumes:
      - ./:/tests
    environment:
      - CYPRESS_baseUrl=http://openfoam_cbp:3000
      #- CYPRESS_baseUrl=http://host.docker.internal:3000
    #extra_hosts:
    #  - "host.docker.internal:host-gateway"
